import{_ as n}from"./Detail.vue_vue&type=script&setup=true&lang.f4dbd703.js";import{x as s,o as a,c as t,D as o,a as e,q as p}from"./vendor.43d648f2.js";import"./Sidebar.c8891f56.js";import"./app.0f81359a.js";const c=e("div",{class:"article-content prose mx-auto"},[e("p",null,[e("div",{class:"article-toc prose"},[e("ul",null,[e("li",null,[e("a",{href:"#%E6%95%88%E6%9E%9C"}," 效果")]),e("li",null,[e("a",{href:"#%E8%B5%B7%E5%9B%A0"}," 起因")]),e("li",null,[e("a",{href:"#%E6%80%9D%E8%B7%AF"}," 思路")]),e("li",null,[e("a",{href:"#%E6%8E%A2%E8%B7%AF"}," 探路")]),e("li",null,[e("a",{href:"#%E5%AE%9E%E7%8E%B0"}," 实现"),e("ul",null,[e("li",null,[e("a",{href:"#%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%9A%E4%BD%BF%E7%94%A8gif%E5%8A%A8%E5%9B%BE"}," 方案一：使用gif动图")]),e("li",null,[e("a",{href:"#%E6%96%B9%E6%A1%88%E4%BA%8C%EF%BC%9A%E5%88%87%E6%8D%A2%E5%9B%BE%E7%89%87%E5%9C%B0%E5%9D%80"}," 方案二：切换图片地址")]),e("li",null,[e("a",{href:"#%E6%96%B9%E6%A1%88%E4%B8%89%EF%BC%9A%E4%BD%BF%E7%94%A8%E5%AE%9A%E6%97%B6%E5%99%A8%E5%88%87%E6%8D%A2%E8%83%8C%E6%99%AF%E5%9B%BE"}," 方案三：使用定时器切换背景图")]),e("li",null,[e("a",{href:"#%E6%96%B9%E6%A1%88%E5%9B%9B%EF%BC%9A%E4%BD%BF%E7%94%A8css3%E9%80%90%E5%B8%A7%E5%8A%A8%E7%94%BB"}," 方案四：使用css3逐帧动画")]),e("li",null,[e("a",{href:"#%E6%96%B9%E6%A1%88%E4%BA%94%EF%BC%9A%E4%BD%BF%E7%94%A8canvas%E9%80%90%E5%B8%A7%E7%BB%98%E5%88%B6"}," 方案五：使用canvas逐帧绘制")])])]),e("li",null,[e("a",{href:"#%E6%9C%80%E5%90%8E"}," 最后")])])])]),e("p",null,[p("前几天愚人节的时候，大话手游官网上了一个专题（"),e("a",{href:"https://dhxy.163.com/2020/gsq/",class:"custom-external-link",target:"_blank",rel:"noopener noreferrer"},"专题地址"),p("），里面很多图片位置都使用了一个类似电影那种画面抖动的效果（目前只剩下一个slogan了，其他都下线了），很好奇是怎么实现的，于是扒了一下页面的源码，了解了一些实现思路，整理一下以后可能会用到。")]),e("h2",{id:"效果"},[e("a",{class:"header-anchor",href:"#效果","aria-hidden":"true"},"#"),p(" 效果")]),e("p",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/1.gif",alt:""})]),e("h2",{id:"起因"},[e("a",{class:"header-anchor",href:"#起因","aria-hidden":"true"},"#"),p(" 起因")]),e("p",null,"其实这个需求如果是直接给你做，你能不能马上有思路去做出来呢？相信大部分人都会有，那我为啥还要去看他们怎么实现的呢？"),e("p",null,"想做这件事的原因，主要是："),e("p",null,"1、想知道对方是怎么实现的，那个抖动的特效，是有素材还是直接前端处理出来的，是不是在自己的预料之中。"),e("p",null,"2、自己虽然能马上想到一些实现方案，但还是想看看是否有更优秀的解决办法，可以偷师学习！"),e("p",null,"3、看看这个效果的素材是怎么处理的，以后遇到类似的需求，我是不是可以把一些锅甩给设计师？"),e("h2",{id:"思路"},[e("a",{class:"header-anchor",href:"#思路","aria-hidden":"true"},"#"),p(" 思路")]),e("p",null,"在看它是怎么实现之前，先凭经验猜测了一下，有多少种可能实现的方式：gif动图、视频、flash、逐帧动画、图片切换、背景图切换、svg、canvas…（前端牛逼啊！！！！）"),e("p",null,"当然每种方法的实现成本不一样，对应的体验和性能也不一样，思路有了，那么来验证一下官网是怎么做的。"),e("h2",{id:"探路"},[e("a",{class:"header-anchor",href:"#探路","aria-hidden":"true"},"#"),p(" 探路")]),e("p",null,"我开始以为是用的视频，因为按网易游戏以往的尿性来说，营销页面上的动态类主视觉基本都是用视频来实现的…那么要怎么看实现方法呢？当然是看DOM啊！"),e("p",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/1-1.jpg",alt:""})]),e("p",null,"所以，用的是canvas，那就有趣了！还好不是视频，直接弄个视频引入的话也就没这篇文章什么事了…"),e("p",null,"canvas的动画效果，都是一帧一帧的定时走出来的，这说明素材是来自设计师之手，不一定是前端直接处理的。"),e("p",null,"接下来就找素材了，这种效果的素材，基本上都是图片，找图片的过程就比较简单了，作为主视觉上这么大的slogan，结合刚刚查看DOM的时候，你发现那个地方的className就叫slogan，那么对应的素材命名，肯定也跟slogan有关，单刀直入切到img，搜索slogan关键词，全都出来了。"),e("p",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/2.jpg",alt:""})]),e("p",null,"可以看出他们是把整个动画过程的每一帧，都处理了一张图片素材，我们先把素材弄下来。"),e("p",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/3.jpg",alt:""})]),e("p",null,"一共有30帧，30张一样尺寸的素材，现在素材有了，接下来就可以开始尝试效果复原。"),e("h2",{id:"实现"},[e("a",{class:"header-anchor",href:"#实现","aria-hidden":"true"},"#"),p(" 实现")]),e("p",null,"实现方案我上面说了，那就一个方案一个方案来看怎么实现，完整的在线demo在文末有地址。"),e("p",null,"方案根据推荐度从低到高说起吧，实现难度基本上也是从低到高这样…"),e("h3",{id:"方案一：使用gif动图"},[e("a",{class:"header-anchor",href:"#方案一：使用gif动图","aria-hidden":"true"},"#"),p(" 方案一：使用gif动图")]),e("p",null,"先从最容易想到的方案说起吧，动图从制作成本来说是最省事的…只需要一个img标签就可以导进来了。"),e("p",null,"【推荐】★★★☆☆"),e("p",null,"【优点】简单，直接导个gif引入就完事，纯html。"),e("p",null,"【弊端】一般来说动图都会比较大，像demo里面只有一个slogan动图都去到了866KB，太多的gif对页面的渲染速度有影响，用户体验不是最佳。"),e("pre",{class:"language-javascript"},[e("code",{class:"language-javascript"},[e("span",{class:"token comment"},"// html"),p("\n"),e("span",{class:"token operator"},"<"),p("section "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"section section-01"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),p("div "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img"'),e("span",{class:"token operator"},">"),p("\n    "),e("span",{class:"token operator"},"<"),p("img src"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img/slogan.gif"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("div"),e("span",{class:"token operator"},">"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("section"),e("span",{class:"token operator"},">"),p("\n")])]),e("h3",{id:"方案二：切换图片地址"},[e("a",{class:"header-anchor",href:"#方案二：切换图片地址","aria-hidden":"true"},"#"),p(" 方案二：切换图片地址")]),e("p",null,"结合我们的素材，已经是处理好一帧一帧这样的过渡状态，那通过定时切换的效果，把他们按指定的时间和顺序切下去，也可以达到想要的效果。"),e("p",null,"【推荐】★★☆☆☆"),e("p",null,"【优点】简单，批量导出每一帧的png素材出来，定时替换图片的地址就完事（而且每一帧的素材都不会很大）。"),e("p",null,"【弊端】需要频繁的操作DOM，性能方面开销太大。"),e("pre",{class:"language-javascript"},[e("code",{class:"language-javascript"},[e("span",{class:"token comment"},"// html"),p("\n"),e("span",{class:"token operator"},"<"),p("section "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"section section-02"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),p("div "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img"'),e("span",{class:"token operator"},">"),p("\n    "),e("span",{class:"token operator"},"<"),p("img src"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img/0.png"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("div"),e("span",{class:"token operator"},">"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("section"),e("span",{class:"token operator"},">"),p("\n\n"),e("span",{class:"token comment"},"// js"),p("\n"),e("span",{class:"token operator"},"<"),p("script type"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"text/javascript"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token keyword"},"const"),p(" slogan "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token punctuation"},"{"),p("\n    index"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p("\n    indexMax"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"29"),e("span",{class:"token punctuation"},","),p("\n    time"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p("\n    dom"),e("span",{class:"token operator"},":"),p(" document"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"querySelector"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'.section-02 .img img'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},","),p("\n    "),e("span",{class:"token function"},"auto"),e("span",{class:"token punctuation"},"("),e("span",{class:"token parameter"},"speed"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"{"),p("\n      "),e("span",{class:"token keyword"},"let"),p(" change "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token function"},"setInterval"),e("span",{class:"token punctuation"},"("),p(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token operator"},"=>"),p(),e("span",{class:"token punctuation"},"{"),p("\n        "),e("span",{class:"token comment"},"// 动态调整图片帧显示"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index "),e("span",{class:"token operator"},"<"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("indexMax "),e("span",{class:"token operator"},"?"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token operator"},"++"),p(),e("span",{class:"token operator"},":"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("dom"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"setAttribute"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'src'"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token template-string"},[e("span",{class:"token template-punctuation string"},"`"),e("span",{class:"token string"},"img/"),e("span",{class:"token interpolation"},[e("span",{class:"token interpolation-punctuation punctuation"},"${"),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token interpolation-punctuation punctuation"},"}")]),e("span",{class:"token string"},".png"),e("span",{class:"token template-punctuation string"},"`")]),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n\n        "),e("span",{class:"token comment"},"// 每运行10次动画周期后销毁定时器，进行垃圾回收后再重新创建"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("time "),e("span",{class:"token operator"},"+="),p(" speed"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token keyword"},"if"),p(),e("span",{class:"token punctuation"},"("),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("time "),e("span",{class:"token operator"},">"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("indexMax "),e("span",{class:"token operator"},"*"),p(" speed "),e("span",{class:"token operator"},"*"),p(),e("span",{class:"token number"},"10"),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token punctuation"},"{"),p("\n          "),e("span",{class:"token function"},"clearInterval"),e("span",{class:"token punctuation"},"("),p("change"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n          change "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token keyword"},"null"),e("span",{class:"token punctuation"},";"),p("\n          "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("time "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},";"),p("\n          "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"auto"),e("span",{class:"token punctuation"},"("),p("speed"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token punctuation"},"}"),p("\n      "),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),p(" speed"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n    "),e("span",{class:"token punctuation"},"}"),p("\n  "),e("span",{class:"token punctuation"},"}"),p("\n  slogan"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"auto"),e("span",{class:"token punctuation"},"("),e("span",{class:"token number"},"100"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("script"),e("span",{class:"token operator"},">"),p("\n")])]),e("h3",{id:"方案三：使用定时器切换背景图"},[e("a",{class:"header-anchor",href:"#方案三：使用定时器切换背景图","aria-hidden":"true"},"#"),p(" 方案三：使用定时器切换背景图")]),e("p",null,"【推荐】★★☆☆☆"),e("p",null,"和方法二比较类似，只不过方法二是切换图片的src，这里是切换div的样式，来达到换背景图的效果，优缺点说起来差不多。"),e("pre",{class:"language-javascript"},[e("code",{class:"language-javascript"},[e("span",{class:"token comment"},"// html"),p("\n"),e("span",{class:"token operator"},"<"),p("section "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"section section-03"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),p("div "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img bg"'),e("span",{class:"token operator"},">"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("div"),e("span",{class:"token operator"},">"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("section"),e("span",{class:"token operator"},">"),p("\n\n"),e("span",{class:"token comment"},"// js"),p("\n"),e("span",{class:"token operator"},"<"),p("script type"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"text/javascript"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token keyword"},"const"),p(" sloganBg "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token punctuation"},"{"),p("\n    index"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p("\n    indexMax"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"29"),e("span",{class:"token punctuation"},","),p("\n    time"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p("\n    dom"),e("span",{class:"token operator"},":"),p(" document"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"querySelector"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'.section-03 .bg'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},","),p("\n    "),e("span",{class:"token function"},"auto"),e("span",{class:"token punctuation"},"("),e("span",{class:"token parameter"},"speed"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"{"),p("\n      "),e("span",{class:"token keyword"},"let"),p(" change "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token function"},"setInterval"),e("span",{class:"token punctuation"},"("),p(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token operator"},"=>"),p(),e("span",{class:"token punctuation"},"{"),p("\n        "),e("span",{class:"token comment"},"// 先移除上一帧的样式"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("dom"),e("span",{class:"token punctuation"},"."),p("classList"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"remove"),e("span",{class:"token punctuation"},"("),e("span",{class:"token template-string"},[e("span",{class:"token template-punctuation string"},"`"),e("span",{class:"token string"},"bg-"),e("span",{class:"token interpolation"},[e("span",{class:"token interpolation-punctuation punctuation"},"${"),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token interpolation-punctuation punctuation"},"}")]),e("span",{class:"token template-punctuation string"},"`")]),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n\n        "),e("span",{class:"token comment"},"// 动态调整图片帧显示"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index "),e("span",{class:"token operator"},"<"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("indexMax "),e("span",{class:"token operator"},"?"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token operator"},"++"),p(),e("span",{class:"token operator"},":"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("dom"),e("span",{class:"token punctuation"},"."),p("classList"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"add"),e("span",{class:"token punctuation"},"("),e("span",{class:"token template-string"},[e("span",{class:"token template-punctuation string"},"`"),e("span",{class:"token string"},"bg-"),e("span",{class:"token interpolation"},[e("span",{class:"token interpolation-punctuation punctuation"},"${"),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token interpolation-punctuation punctuation"},"}")]),e("span",{class:"token template-punctuation string"},"`")]),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n\n        "),e("span",{class:"token comment"},"// 每运行10次动画周期后销毁定时器，进行垃圾回收后再重新创建"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("time "),e("span",{class:"token operator"},"+="),p(" speed"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token keyword"},"if"),p(),e("span",{class:"token punctuation"},"("),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("time "),e("span",{class:"token operator"},">"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("indexMax "),e("span",{class:"token operator"},"*"),p(" speed "),e("span",{class:"token operator"},"*"),p(),e("span",{class:"token number"},"10"),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token punctuation"},"{"),p("\n          "),e("span",{class:"token function"},"clearInterval"),e("span",{class:"token punctuation"},"("),p("change"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n          change "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token keyword"},"null"),e("span",{class:"token punctuation"},";"),p("\n          "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("time "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},";"),p("\n          "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"auto"),e("span",{class:"token punctuation"},"("),p("speed"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token punctuation"},"}"),p("\n      "),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),p(" speed"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n    "),e("span",{class:"token punctuation"},"}"),p("\n  "),e("span",{class:"token punctuation"},"}"),p("\n  sloganBg"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"auto"),e("span",{class:"token punctuation"},"("),e("span",{class:"token number"},"100"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("script"),e("span",{class:"token operator"},">"),p("\n")])]),e("h3",{id:"方案四：使用css3逐帧动画"},[e("a",{class:"header-anchor",href:"#方案四：使用css3逐帧动画","aria-hidden":"true"},"#"),p(" 方案四：使用css3逐帧动画")]),e("p",null,"这个办法我是比较推荐的，实现成本并不高，写起来也很简单，体验又好。"),e("p",null,"【推荐】★★★★☆"),e("p",null,"【优点】简单，性能好，生成雪碧图，然后写个动画就完事。"),e("p",null,"【弊端】部分古董设备不兼容，然后还有个问题，就是像demo里的这个素材，做成雪碧图贼他妈大（2.24MB，经过tinypin压缩后还是有640KB），所以素材太大的情况下，最好不要用这个办法来搞。"),e("pre",{class:"language-javascript"},[e("code",{class:"language-javascript"},[e("span",{class:"token comment"},"// css"),p("\n"),e("span",{class:"token operator"},"<"),p("style"),e("span",{class:"token operator"},">"),p("\n"),e("span",{class:"token punctuation"},"."),p("go "),e("span",{class:"token punctuation"},"{"),p("\n  background"),e("span",{class:"token operator"},"-"),p("image"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token function"},"url"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'../img/sprites.png'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n  background"),e("span",{class:"token operator"},"-"),p("repeat"),e("span",{class:"token operator"},":"),p(" no"),e("span",{class:"token operator"},"-"),p("repeat"),e("span",{class:"token punctuation"},";"),p("\n  animation"),e("span",{class:"token operator"},":"),p(" go "),e("span",{class:"token function"},"steps"),e("span",{class:"token punctuation"},"("),e("span",{class:"token number"},"29"),e("span",{class:"token punctuation"},","),p(" end"),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token number"},"3"),p("s infinite"),e("span",{class:"token punctuation"},";"),p("\n"),e("span",{class:"token punctuation"},"}"),p("\n@keyframes go "),e("span",{class:"token punctuation"},"{"),p("\n  "),e("span",{class:"token number"},"100"),e("span",{class:"token operator"},"%"),p(),e("span",{class:"token punctuation"},"{"),p("\n    background"),e("span",{class:"token operator"},"-"),p("position"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token operator"},"-"),e("span",{class:"token number"},"0"),p(),e("span",{class:"token operator"},"-"),e("span",{class:"token number"},"8729"),p("px"),e("span",{class:"token punctuation"},";"),p("\n"),e("span",{class:"token punctuation"},"}"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("style"),e("span",{class:"token operator"},">"),p("\n\n"),e("span",{class:"token comment"},"// html"),p("\n"),e("span",{class:"token operator"},"<"),p("section "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"section section-04"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),p("div "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img bg go"'),e("span",{class:"token operator"},">"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("div"),e("span",{class:"token operator"},">"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("section"),e("span",{class:"token operator"},">"),p("\n")])]),e("p",null,"实现思路："),e("p",null,"1、把所有的帧素材都合并为一张雪碧图，减少http请求，通过animation的背景图移动来实现视觉上的切换。"),e("p",null,"2、这里运用到了css3的animation-timing-function的steps，减少动画过程的代码编写"),e("p",null,"3、结合第2点，因为steps(number, position)的两个参数，第一个参数是设定有多少帧，第二个参数是设置动画的连续方式，所以根据steps的特性，我们生成的雪碧图需要无间隔并且连贯（我生成的就是从上到下排序下来的）"),e("p",null,[p("这里推荐一个在线工具："),e("a",{href:"https://www.toptal.com/developers/css/sprite-generator",class:"custom-external-link",target:"_blank",rel:"noopener noreferrer"},"快速生成雪碧图")]),e("p",null,[p("还有关于里面的steps的用法，可以参考张老师的文章："),e("a",{href:"https://www.zhangxinxu.com/wordpress/2018/06/css3-animation-steps-step-start-end/",class:"custom-external-link",target:"_blank",rel:"noopener noreferrer"},"CSS3 animation属性中的steps功能符深入介绍 ")]),e("h3",{id:"方案五：使用canvas逐帧绘制"},[e("a",{class:"header-anchor",href:"#方案五：使用canvas逐帧绘制","aria-hidden":"true"},"#"),p(" 方案五：使用canvas逐帧绘制")]),e("p",null,"终于来到一开头提到的canvas实现方案了。大话官网专题，我看了一下源代码，虽然代码被混淆，但还是可以看出，应该是通过引入插件来实现的。"),e("p",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/4.jpg",alt:""})]),e("p",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/5.jpg",alt:""})]),e("p",null,"我们自己写其实也不难，因为知道了本身的实现套路（有逐帧素材，然后通过逐帧逐帧去绘制渲染出来），那就可以着手编写代码了。"),e("p",null,"【推荐】★★★★★"),e("p",null,"【优点】canvas在性能上有天然的优势，对于高频率的更新渲染，用canvas重绘来实现效果更佳。"),e("p",null,"【弊端】古董机对canvas的兼容性不太友好，如果可以抛弃这些古董用户的话，还是推荐这个方案！"),e("pre",{class:"language-javascript"},[e("code",{class:"language-javascript"},[e("span",{class:"token comment"},"// html"),p("\n"),e("span",{class:"token operator"},"<"),p("section "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"section section-05"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token operator"},"<"),p("div "),e("span",{class:"token keyword"},"class"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"img"'),e("span",{class:"token operator"},">"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("div"),e("span",{class:"token operator"},">"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("section"),e("span",{class:"token operator"},">"),p("\n\n"),e("span",{class:"token comment"},"// js"),p("\n"),e("span",{class:"token operator"},"<"),p("script type"),e("span",{class:"token operator"},"="),e("span",{class:"token string"},'"text/javascript"'),e("span",{class:"token operator"},">"),p("\n  "),e("span",{class:"token keyword"},"const"),p(" sloganCanvas "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token punctuation"},"{"),p("\n    index"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p("\n    indexMax"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"29"),e("span",{class:"token punctuation"},","),p("\n    canvasWidth"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"801"),e("span",{class:"token punctuation"},","),p("\n    canvasHeight"),e("span",{class:"token operator"},":"),p(),e("span",{class:"token number"},"301"),e("span",{class:"token punctuation"},","),p("\n    "),e("span",{class:"token function"},"init"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"{"),p("\n      "),e("span",{class:"token comment"},"// 创建画布"),p("\n      "),e("span",{class:"token keyword"},"const"),p(" canvas "),e("span",{class:"token operator"},"="),p(" document"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"createElement"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'canvas'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n      canvas"),e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},"'width'"),e("span",{class:"token punctuation"},"]"),p(),e("span",{class:"token operator"},"="),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("canvasWidth"),e("span",{class:"token punctuation"},";"),p("\n      canvas"),e("span",{class:"token punctuation"},"["),e("span",{class:"token string"},"'height'"),e("span",{class:"token punctuation"},"]"),p(),e("span",{class:"token operator"},"="),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("canvasHeight"),e("span",{class:"token punctuation"},";"),p("\n      document"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"querySelector"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'.section-05 .img'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"appendChild"),e("span",{class:"token punctuation"},"("),p("canvas"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n\n      "),e("span",{class:"token comment"},"// 绘制内容"),p("\n      "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"draw"),e("span",{class:"token punctuation"},"("),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token punctuation"},","),p(" canvas"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n    "),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),p("\n    "),e("span",{class:"token function"},"draw"),e("span",{class:"token punctuation"},"("),e("span",{class:"token parameter"},[p("index"),e("span",{class:"token punctuation"},","),p(" canvas")]),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},"{"),p("\n      "),e("span",{class:"token keyword"},"const"),p(" context "),e("span",{class:"token operator"},"="),p(" canvas"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"getContext"),e("span",{class:"token punctuation"},"("),e("span",{class:"token string"},"'2d'"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n      "),e("span",{class:"token keyword"},"const"),p(" img "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token keyword"},"new"),p(),e("span",{class:"token class-name"},"Image"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n      img"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function-variable function"},"onload"),p(),e("span",{class:"token operator"},"="),p(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token operator"},"=>"),p(),e("span",{class:"token punctuation"},"{"),p("\n        "),e("span",{class:"token comment"},"// 绘制前先清空画布"),p("\n        context"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"clearRect"),e("span",{class:"token punctuation"},"("),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("canvasWidth"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("canvasHeight"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n\n        "),e("span",{class:"token comment"},"// 然后再绘制当前帧"),p("\n        context"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"drawImage"),e("span",{class:"token punctuation"},"("),p("img"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("canvasWidth"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("canvasHeight"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n\n        "),e("span",{class:"token comment"},"// 画完更换下一帧的索引"),p("\n        "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index "),e("span",{class:"token operator"},"<"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("indexMax "),e("span",{class:"token operator"},"?"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token operator"},"++"),p(),e("span",{class:"token operator"},":"),p(),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token number"},"0"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token function"},"setTimeout"),e("span",{class:"token punctuation"},"("),p(),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),p(),e("span",{class:"token operator"},"=>"),p(),e("span",{class:"token punctuation"},"{"),p("\n          "),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"draw"),e("span",{class:"token punctuation"},"("),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token punctuation"},","),p(" canvas"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n        "),e("span",{class:"token punctuation"},"}"),e("span",{class:"token punctuation"},","),p(),e("span",{class:"token number"},"100"),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n      "),e("span",{class:"token punctuation"},"}"),p("\n      img"),e("span",{class:"token punctuation"},"."),p("src "),e("span",{class:"token operator"},"="),p(),e("span",{class:"token template-string"},[e("span",{class:"token template-punctuation string"},"`"),e("span",{class:"token string"},"img/"),e("span",{class:"token interpolation"},[e("span",{class:"token interpolation-punctuation punctuation"},"${"),e("span",{class:"token keyword"},"this"),e("span",{class:"token punctuation"},"."),p("index"),e("span",{class:"token interpolation-punctuation punctuation"},"}")]),e("span",{class:"token string"},".png"),e("span",{class:"token template-punctuation string"},"`")]),e("span",{class:"token punctuation"},";"),p("\n    "),e("span",{class:"token punctuation"},"}"),p("\n  "),e("span",{class:"token punctuation"},"}"),p("\n  sloganCanvas"),e("span",{class:"token punctuation"},"."),e("span",{class:"token function"},"init"),e("span",{class:"token punctuation"},"("),e("span",{class:"token punctuation"},")"),e("span",{class:"token punctuation"},";"),p("\n"),e("span",{class:"token operator"},"<"),e("span",{class:"token operator"},"/"),p("script"),e("span",{class:"token operator"},">"),p("\n")])]),e("p",null,"实现思路："),e("p",null,"1、动态创建canvas，不要写死canvas的宽度和高度，实际需求如果要覆盖移动端，请动态计算尺寸后生成（官网专题是不做移动端了，移动端纯jpg图，感觉有点可惜）"),e("p",null,"2、载入每帧的素材的时候，后续操作都要放在img的onload事件里执行"),e("p",null,"3、每次进行绘制之前，记得先清空画布，否则会一直叠加绘制，就没法看了…"),e("p",null,"4、通过setTimeout的延时回调控制无限循环动画的速度"),e("h2",{id:"最后"},[e("a",{class:"header-anchor",href:"#最后","aria-hidden":"true"},"#"),p(" 最后")]),e("p",null,"有几个方案我没有写，关于svg对这个需求的实现，暂时没有思路，我选择放弃，以后想到了再来补上！"),e("p",null,"而视频和flash这些多媒体的展示方案，这里就略过了，处理成本对我来说还是比较高的，要配合设计的主视觉去输出优质的素材，我不太擅长…（所以这种方案可以考虑把活交给设计师…）"),e("p",null,[p("最后放上demo地址："),e("a",{href:"https://chengpeiquan.github.io/canvas-movie-jitter-effect/index.html",class:"custom-external-link",target:"_blank",rel:"noopener noreferrer"},"电影抖屏效果demo")])],-1),l={expose:[],setup(e){const p={title:"电影故障抖动视觉效果实现：对大话手游愚人节专题的探究",desc:"前几天愚人节的时候，大话手游官网上了一个专题，里面很多图片位置都使用了一个类似电影那种画面抖动的效果（目前只剩下一个slogan了，其他都下线了），很好奇是怎么实现的，于是扒了一下页面的源码，了解了一些实现思路，整理一下以后可能会用到。",keywords:"抖屏效果",date:"2020/04/20 23:47:00",cover:"https://cdn.jsdelivr.net/gh/chengpeiquan/assets-storage/img/2020/04/1.jpg",meta:[{property:"og:title",content:"电影故障抖动视觉效果实现：对大话手游愚人节专题的探究"}]};return s({title:"电影故障抖动视觉效果实现：对大话手游愚人节专题的探究",meta:[{property:"og:title",content:"电影故障抖动视觉效果实现：对大话手游愚人节专题的探究"}]}),(s,e)=>{const l=n;return a(),t(l,{frontmatter:p},{default:o((()=>[c])),_:1})}}};export default l;
